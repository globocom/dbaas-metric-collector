<!DOCTYPE html>
<html>
<head>
  <title>Graphs</title>
  <script type="text/javascript" src="http://code.highcharts.com/highcharts.js"></script>
  <script type="text/javascript" src="js/jquery.min.js"></script>

  <script type="text/javascript" language="javascript">
    $(document).ready(function() {
      $.getJSON('database_count', function(response) {
        labels = []
        data = []
        for (var i = 0, len = response.length; i < len; i++) {
          labels = labels.concat(response[i]['Moment']);
          data = data.concat(parseInt(response[i]['Count']));
        }

        Highcharts.chart('database_count', {
          chart: {
            type: 'line'
          },
          title: {
            text: '# of Databases'
          },
          legend: {
            enabled: false
          },
          xAxis: {
            categories: labels
          },
          yAxis: {
            title: {
              text: '# of Databases',
            },
          },
          series: [{
            name: 'Databases',
            data: data
          }]
        });
      });

      $.getJSON('team_count', function(response) {
        data = []
        for (var i = 0, len = response['Teams'].length; i < len; i++) {
          name = response['Teams'][i]['Name'];
          value = parseInt(response['Teams'][i]['Count']); 
          data = data.concat([[name, value],])
        }

        data.sort(function(first, second) {
          return second[1] - first[1];
        });

        Highcharts.chart('team_count', {
          chart: {
            type: 'column'
          },
          title: {
            text: 'Databases per team at ' + response['Moment']
          },
          xAxis: {
            type: 'category'
          },
          yAxis: {
            title: {
              text: '# of Databases',
            },
          },
          legend: {
            enabled: false
          },
          series: [{
            data: data,
            dataLabels: {
              enabled: true,
            }
          }]
        });
      });

      $.getJSON('project_count', function(response) {
        data = []
        for (var i = 0, len = response['Projects'].length; i < len; i++) {
          name = response['Projects'][i]['Name'];
          value = parseInt(response['Projects'][i]['Count']);
          data = data.concat([[name, value],])
        }

        data.sort(function(first, second) {
          return second[1] - first[1];
        });

        Highcharts.chart('project_count', {
          chart: {
            type: 'column'
          },
          title: {
            text: 'Databases per project at ' + response['Moment']
          },
          xAxis: {
            type: 'category',
          },
          yAxis: {
            title: {
              text: '# of Databases',
            },
          },
          legend: {
            enabled: false
          },
          series: [{
            data: data,
            dataLabels: {
              enabled: true,
            }
          }]
        });
      });

      $.getJSON('environment_count', function(response) {
        data = []
        for (var i = 0, len = response['Environments'].length; i < len; i++) {
          name = response['Environments'][i]['Name'];
          value = parseInt(response['Environments'][i]['Count']);
          data = data.concat([[name, value],])
        }

        data.sort(function(first, second) {
          return second[1] - first[1];
        });

        Highcharts.chart('environment_count', {
          chart: {
            type: 'column'
          },
          title: {
            text: 'Databases per environment at ' + response['Moment']
          },
          xAxis: {
            type: 'category',
          },
          yAxis: {
            title: {
              text: '# of Databases',
            },
          },
          legend: {
            enabled: false
          },
          series: [{
            data: data,
            dataLabels: {
              enabled: true,
            }
          }]
        });
      });
    });
  </script>
</head>

<body>
  <div id="database_count" style="width:100%; height:400px;"></div>
  <div id="team_count" style="width:100%; height:400px;"></div>
  <div id="project_count" style="width:100%; height:400px;"></div>
  <div id="environment_count" style="width:100%; height:400px;"></div>
</body>

  <script type="text/javascript">
</script>
</html>